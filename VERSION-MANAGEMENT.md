# Version Management Guide

## Current Status

**Version**: 0.6.2  
**Manual Control**: ✅ Enabled

## How to Release a New Version

The auto-bump feature has been **removed**. You now have full manual control over versioning.

### Step-by-Step Release Process

1. **Update the version in package.json**
   ```bash
   # Edit package.json and change the version field
   # Example: "version": "0.6.3"
   ```

2. **Update package-lock.json**
   ```bash
   npm install --package-lock-only
   ```

3. **Commit your changes**
   ```bash
   git add .
   git commit -m "feat: your feature description"
   git push origin master
   ```

4. **Create and push a version tag**
   ```bash
   git tag -a v0.6.3 -m "Release v0.6.3"
   git push origin v0.6.3
   ```

5. **GitHub Actions will automatically**:
   - Verify the tag version matches package.json
   - Run tests
   - Create a GitHub release with HTML files attached
   - Generate comprehensive release notes

## Version Files

These files contain version numbers that should be kept in sync:

- `package.json` - Main version reference
- `package-lock.json` - Auto-generated by npm, keep in sync

## Workflow Changes

### Before (Auto-Bump)
- ❌ Pushed to master → GitHub Actions auto-bumped version
- ❌ Created automatic commits by "GitHub Action" user
- ❌ Created tags automatically
- ❌ No control over version numbers

### After (Manual Control)
- ✅ You manually update `package.json` version
- ✅ You create and push tags when ready to release
- ✅ GitHub Actions only triggers on tag push
- ✅ Workflow verifies tag matches package.json version
- ✅ Full control over when releases happen

## Version Numbering

We follow [Semantic Versioning](https://semver.org/):

- **Major** (X.0.0): Breaking changes
- **Minor** (0.X.0): New features, backward compatible
- **Patch** (0.0.X): Bug fixes, backward compatible

### Examples
- `0.6.2` → `0.6.3` - Bug fix
- `0.6.2` → `0.7.0` - New feature
- `0.6.2` → `1.0.0` - Breaking change

## Release Checklist

- [ ] Update version in `package.json`
- [ ] Run `npm install --package-lock-only` to sync `package-lock.json`
- [ ] Update `RELEASE-vX.X.X.md` with release notes (optional)
- [ ] Commit changes: `git commit -m "chore: bump version to X.X.X"`
- [ ] Push commits: `git push origin master`
- [ ] Create tag: `git tag -a vX.X.X -m "Release vX.X.X"`
- [ ] Push tag: `git push origin vX.X.X`
- [ ] Verify GitHub Actions workflow succeeds
- [ ] Check GitHub Releases page for new release

## Troubleshooting

### Tag version doesn't match package.json
If you see: `Error: Tag version (v0.6.3) does not match package.json version (0.6.2)`

**Solution**: Update package.json to match the tag, or delete and recreate the tag:
```bash
# Option 1: Update package.json
# Edit package.json version to match tag

# Option 2: Recreate the tag
git tag -d v0.6.3              # Delete local tag
git push origin :v0.6.3        # Delete remote tag
git tag -a v0.6.3 -m "..."     # Create new tag
git push origin v0.6.3         # Push new tag
```

### Release not created
- Check the [Actions tab](https://github.com/mikejsmith1985/jira-html-parser/actions) for workflow logs
- Ensure tag starts with 'v' (e.g., `v0.6.3`, not `0.6.3`)
- Verify you pushed the tag: `git push origin v0.6.3`

## GitHub Actions User

**Q: Who is "GitHub Action"?**  
A: This is the automated user created by your GitHub Actions workflow. Not a real person - it's your own automation.

**Q: Has my code been tampered with?**  
A: No. The "GitHub Action" commits were created by `.github/workflows/release.yml` in your repository. Only you can modify this file.

## Current Workflow

The workflow file: `.github/workflows/release.yml`

**Triggers on**: Push of tags starting with 'v' (e.g., `v0.6.3`)

**Actions**:
1. Checkout code
2. Verify tag version matches package.json
3. Run tests
4. Create GitHub release with:
   - `link-generator.html` (recommended)
   - `jira-link-generator.html` (deprecated)
   - `servicenow-link-generator.html` (deprecated)
   - `package.json`
   - `README.md`

## History

- **v0.6.0**: Initial release with unified tool
- **v0.6.1**: Auto-bumped by GitHub Actions (unintentional)
- **v0.6.2**: Auto-bumped by GitHub Actions (unintentional)
- **v0.6.2+**: Manual version control enabled

---

Last updated: 2025-01-16
